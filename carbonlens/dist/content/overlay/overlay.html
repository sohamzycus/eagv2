<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CarbonLens Trace</title>
  <link rel="stylesheet" href="overlay.css">
</head>
<body>
  <div class="overlay-container">
    <!-- Header -->
    <div class="overlay-header">
      <div class="header-content">
        <div class="logo">
          <svg width="24" height="24" viewBox="0 0 128 128" fill="none">
            <circle cx="64" cy="64" r="60" fill="url(#carbonGradient)" stroke="url(#borderGradient)" stroke-width="2"/>
            <g transform="translate(64, 64)">
              <circle cx="0" cy="0" r="8" fill="#2D3748" stroke="#4A5568" stroke-width="2"/>
              <circle cx="-20" cy="-20" r="6" fill="#38A169" stroke="#48BB78" stroke-width="1.5"/>
              <circle cx="20" cy="-20" r="6" fill="#38A169" stroke="#48BB78" stroke-width="1.5"/>
              <circle cx="20" cy="20" r="6" fill="#38A169" stroke="#48BB78" stroke-width="1.5"/>
              <circle cx="-20" cy="20" r="6" fill="#38A169" stroke="#48BB78" stroke-width="1.5"/>
              <line x1="0" y1="0" x2="-20" y2="-20" stroke="#4A5568" stroke-width="2"/>
              <line x1="0" y1="0" x2="20" y2="-20" stroke="#4A5568" stroke-width="2"/>
              <line x1="0" y1="0" x2="20" y2="20" stroke="#4A5568" stroke-width="2"/>
              <line x1="0" y1="0" x2="-20" y2="20" stroke="#4A5568" stroke-width="2"/>
            </g>
            <defs>
              <linearGradient id="carbonGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#E6FFFA;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#81E6D9;stop-opacity:1" />
              </linearGradient>
              <linearGradient id="borderGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#38A169;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#2F855A;stop-opacity:1" />
              </linearGradient>
            </defs>
          </svg>
        </div>
        <div class="title">
          <h3>Agent Trace</h3>
          <span class="status" id="traceStatus">Ready</span>
        </div>
        <button class="close-btn" id="closeOverlay">&times;</button>
      </div>
    </div>

    <!-- Trace Container -->
    <div class="trace-container" id="traceContainer">
      <div class="welcome-state" id="welcomeState">
        <div class="welcome-icon">ðŸ¤–</div>
        <h4>Agent Execution Trace</h4>
        <p>Start a task in the popup to see the AI agent's decision-making process in real-time.</p>
        <div class="trace-legend">
          <div class="legend-item">
            <span class="legend-dot plan"></span>
            <span>Planning</span>
          </div>
          <div class="legend-item">
            <span class="legend-dot tool-call"></span>
            <span>Tool Execution</span>
          </div>
          <div class="legend-item">
            <span class="legend-dot tool-result"></span>
            <span>Results</span>
          </div>
          <div class="legend-item">
            <span class="legend-dot final"></span>
            <span>Final Answer</span>
          </div>
        </div>
      </div>

      <!-- Trace Steps -->
      <div class="trace-steps" id="traceSteps">
        <!-- Steps will be dynamically added here -->
      </div>
    </div>

    <!-- Controls -->
    <div class="overlay-controls">
      <button class="control-btn" id="clearTraceBtn" title="Clear Trace">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="3,6 5,6 21,6"></polyline>
          <path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
        </svg>
      </button>
      <button class="control-btn" id="exportTraceBtn" title="Export Trace">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          <polyline points="7,10 12,15 17,10"></polyline>
          <line x1="12" y1="15" x2="12" y2="3"></line>
        </svg>
      </button>
      <button class="control-btn" id="toggleAutoScrollBtn" title="Toggle Auto-scroll" data-enabled="true">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="m7 11 5 5 5-5"></path>
          <path d="m7 6 5 5 5-5"></path>
        </svg>
      </button>
    </div>
  </div>

  <script src="overlay.js"></script>
</body>
</html>
